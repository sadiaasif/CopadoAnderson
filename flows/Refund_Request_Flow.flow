<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>52.0</apiVersion>
    <assignments>
        <name>AsnRequestType</name>
        <label>AsnRequestType</label>
        <locationX>1416</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>varRequestType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Duplicate Charge</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Refund_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AsnRequestType_0</name>
        <label>AsnRequestType</label>
        <locationX>1116</locationX>
        <locationY>544</locationY>
        <assignmentItems>
            <assignToReference>varRequestType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Research</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Research_Screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AsnRequestType_0_0</name>
        <label>AsnRequestType</label>
        <locationX>610</locationX>
        <locationY>526</locationY>
        <assignmentItems>
            <assignToReference>varRequestType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Refund</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Refund_Request_Flow</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AsnRequestType_0_0_0</name>
        <label>AsnRequestType</label>
        <locationX>402</locationX>
        <locationY>355</locationY>
        <assignmentItems>
            <assignToReference>varRequestType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Credit</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Find_Credit_Sale</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_Text</name>
        <label>Update Text</label>
        <locationX>765</locationX>
        <locationY>50</locationY>
        <assignmentItems>
            <assignToReference>serviceDisplayText</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>{!loopOppProd.Service_Name__c} - </stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>serviceDisplayText</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Qty: {!loopOppProd.Quantity} - </stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>serviceDisplayText</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Price: ${!loopOppProd.TotalPrice} </stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>serviceDisplayText</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>LineBreak</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Looping</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Credit</name>
        <choiceText>Credit</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>DuplicateCharge2</name>
        <choiceText>Duplicate Charge (for &lt;b&gt;same-day duplicates&lt;/b&gt; to be voided immediately)</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Duplicate</stringValue>
        </value>
    </choices>
    <choices>
        <name>Refund</name>
        <choiceText>Refund</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Refund</stringValue>
        </value>
    </choices>
    <choices>
        <name>Research</name>
        <choiceText>Research</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Research</stringValue>
        </value>
    </choices>
    <constants>
        <name>LineBreak</name>
        <dataType>String</dataType>
        <value>
            <stringValue>&lt;br&gt;&lt;/br&gt;</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Does_Kambria_want_to_Expedite</name>
        <label>Does Kambria want to Expedite?</label>
        <locationX>617</locationX>
        <locationY>1093</locationY>
        <defaultConnector>
            <targetReference>Sale_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Send_to_Michelle_immediately</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Refund_0_0</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the current user is Kambria</description>
        <name>Is_Current_User_Kambria</name>
        <label>Is Current User Kambria?</label>
        <locationX>401</locationX>
        <locationY>754</locationY>
        <defaultConnector>
            <targetReference>Sale_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CurrentUser</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Kambria Stephen</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>KambriasScreen</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Shows a second screen based on Sale Type</description>
        <name>Sale_Type</name>
        <label>Sale Type</label>
        <locationX>817</locationX>
        <locationY>751</locationY>
        <defaultConnector>
            <targetReference>Are_you_a_manager</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Any Other Sale Type</defaultConnectorLabel>
        <rules>
            <name>Other_Refund</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_this_refund_for_tax_penalties_hotel_cancellation_fees_or_other_items</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Yes</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>OtherScreen</targetReference>
            </connector>
            <label>Other Refund</label>
        </rules>
        <rules>
            <name>Platinum_Subscription</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SaleType</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Platinum</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Platinum_Subscription_Screen</targetReference>
            </connector>
            <label>Platinum Subscription</label>
        </rules>
        <rules>
            <name>Events_Ticket</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SaleType</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Event</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Events_Screen</targetReference>
            </connector>
            <label>Event Ticket</label>
        </rules>
    </decisions>
    <decisions>
        <description>Prevents the flow from changing the Sales stage to &quot;Refund Requested&quot; when the refund request is from a Duplicate Charge or a Payment Research Request.</description>
        <name>Should_Flow_Change_Sale_Stage</name>
        <label>Should Flow Change Sale Stage?</label>
        <locationX>1829</locationX>
        <locationY>785</locationY>
        <defaultConnector>
            <targetReference>Update_Sale</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Yes</defaultConnectorLabel>
        <rules>
            <name>No</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>DuplicateCharge2</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Research</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Complete</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <name>Type_of_Request0</name>
        <label>Type of Request</label>
        <locationX>945</locationX>
        <locationY>358</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Duplicate_Charge</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>DuplicateCharge2</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AsnRequestType</targetReference>
            </connector>
            <label>Duplicate Charge</label>
        </rules>
        <rules>
            <name>Credit0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Credit</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AsnRequestType_0_0_0</targetReference>
            </connector>
            <label>Credit</label>
        </rules>
        <rules>
            <name>Research0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Research</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AsnRequestType_0</targetReference>
            </connector>
            <label>Research</label>
        </rules>
        <rules>
            <name>Refund0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Refund</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AsnRequestType_0_0</targetReference>
            </connector>
            <label>Refund</label>
        </rules>
    </decisions>
    <description>Updated as per ticket 00135476</description>
    <dynamicChoiceSets>
        <name>DuplicateCharge</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Is_this_a_duplicate_charge__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>isKeepingPlatinum</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Is_the_client_keeping_Platinum_services__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
        <sortOrder>Asc</sortOrder>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>MailingAddressConfirmedChoices</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Mailing_Address_Confirmed__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>OtherItems</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Other_Items__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>PaymentResearchRequest</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Payment_Research_Requested__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>RefundOrCredit</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Refund_or_Credit__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>RefundReason</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Refund_Reason__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>RefundRequestForm</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Refund_Request_Signed__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>ResearchType</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Payment_Research_Type__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>YesorNo</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Refund_Request_Signed__c</picklistField>
        <picklistObject>Refund__c</picklistObject>
    </dynamicChoiceSets>
    <formulas>
        <name>AccountAddress</name>
        <dataType>String</dataType>
        <expression>{!ShippingStreet} + &quot; &quot; + {!ShippingCity} + &quot; &quot; + {!ShippingState} + &quot; &quot; + {!ShippingZip} + &quot; &quot; + {!ShippingCountry}</expression>
    </formulas>
    <formulas>
        <name>AmountFormula</name>
        <dataType>Currency</dataType>
        <expression>CASE({!varRequestType},
&quot;Credit&quot;, {!Credit_Amount},
{!Refund_Amount})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>CommentsFormula</name>
        <dataType>String</dataType>
        <expression>IF({!Send_to_Michelle_immediately} = TRUE, {!Expedited_Comments}, 
IF(CONTAINS({!Type_of_Request}, &quot;Duplicate&quot;), &quot;This request was created by &quot; + {!$User.FirstName} + &quot; &quot; + {!$User.LastName} + &quot;. They indicated they would like the duplicate charge on the Sale voided because it occurred today.&quot;, 
&quot;&quot;))</expression>
    </formulas>
    <formulas>
        <name>CurrentUser</name>
        <dataType>String</dataType>
        <expression>{!$User.FirstName} + &quot; &quot; + {!$User.LastName}</expression>
    </formulas>
    <formulas>
        <name>DuplicateChargeFormula</name>
        <dataType>String</dataType>
        <expression>IF(CONTAINS({!Type_of_Request}, &quot;Duplicate&quot;), &quot;Yes&quot;, &quot;No&quot;)</expression>
    </formulas>
    <formulas>
        <name>ExpediteFormula</name>
        <dataType>Boolean</dataType>
        <expression>IF({!Yes_please_expedite_directly_to_Michelle} = TRUE, TRUE,
IF({!Send_to_Michelle_immediately} = TRUE, TRUE,
FALSE))</expression>
    </formulas>
    <formulas>
        <name>fmResearchRequest</name>
        <dataType>String</dataType>
        <expression>IF(CONTAINS({!Type_of_Request}, &quot;Research&quot;), &quot;Yes&quot;, &quot;No&quot;)</expression>
    </formulas>
    <formulas>
        <name>OtherItemsFormula</name>
        <dataType>String</dataType>
        <expression>{!Other_Items_Description} + &quot; &quot; + {!OtherDescription}</expression>
    </formulas>
    <formulas>
        <name>OwnerFormula</name>
        <dataType>String</dataType>
        <expression>IF( {!Send_to_Michelle_immediately} = TRUE, &quot;0056f00000AH2CZAA1&quot;,
IF({!Yes_please_expedite_directly_to_Michelle} = TRUE, &quot;0056f00000AH2CZAA1&quot;, 
IF(CONTAINS({!varRequestType}, &quot;Credit&quot;), &quot;0056f00000AH2CZAA1&quot;,
IF( CONTAINS({!Type_of_Request}, &quot;Duplicate&quot;), &quot;0056f00000AH2CZAA1&quot;,
IF( {!Is_this_refund_for_tax_penalties_hotel_cancellation_fees_or_other_items} = &quot;Yes&quot;, &quot;0056f00000BFt5GAAT&quot;,
IF(CONTAINS({!Type_of_Request}, &quot;Research&quot;) , &quot;0056f00000AH2CZAA1&quot;,
IF( CONTAINS({!SaleType}, &quot;Platinum&quot;), &quot;0056f00000AH2CZAA1&quot;,
IF( CONTAINS({!SaleType}, &quot;Renewal&quot;), &quot;0056f00000AH2CZAA1&quot;,
IF(CONTAINS({!SaleType}, &quot;Entity Formation&quot;), &quot;0056f00000BFt5GAAT&quot;,
IF( CONTAINS({!SaleType}, &quot;Bookkeeping&quot;), &quot;0056f00000BFt5GAAT&quot;,
IF(CONTAINS({!SaleType}, &quot;Event&quot;), &quot;0050B000006naKlQAI&quot;,
IF( CONTAINS({!SaleType}, &quot;Compliance&quot;), &quot;0056f00000BFt5GAAT&quot;, &quot;0056f00000BFt5GAAT&quot;
))))))))))))</expression>
    </formulas>
    <formulas>
        <name>RefundNameFormula</name>
        <dataType>String</dataType>
        <expression>LEFT({!ClientName} + &quot; - &quot; + {!SaleName}, 80)</expression>
    </formulas>
    <formulas>
        <name>RefundVsCredit</name>
        <dataType>String</dataType>
        <expression>&quot;t&quot;</expression>
    </formulas>
    <formulas>
        <name>ServiceORRefundServiceselected</name>
        <dataType>String</dataType>
        <expression>If(NOT(ISBlank({!Which_services_are_being_refunded})),{!Which_services_are_being_refunded},{!Which_services_are_being_credited})</expression>
    </formulas>
    <formulas>
        <name>StatusFormula</name>
        <dataType>String</dataType>
        <expression>IF({!Yes_please_expedite_directly_to_Michelle}, &quot;Review&quot;, &quot;New&quot;)</expression>
    </formulas>
    <interviewLabel>Refund Request Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Refund Request Flow</label>
    <loops>
        <name>Looping</name>
        <label>Looping</label>
        <locationX>762</locationX>
        <locationY>213</locationY>
        <assignNextValueToReference>loopOppProd</assignNextValueToReference>
        <collectionReference>OppOLIs</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Update_Text</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Refund_Credit_or_Research</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Refund</name>
        <label>Create Refund</label>
        <locationX>1693</locationX>
        <locationY>783</locationY>
        <connector>
            <targetReference>Should_Flow_Change_Sale_Stage</targetReference>
        </connector>
        <inputAssignments>
            <field>Amount__c</field>
            <value>
                <elementReference>AmountFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Check_or_Wire_Amount__c</field>
            <value>
                <elementReference>Check_or_Wire_Amount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client__c</field>
            <value>
                <elementReference>AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client_s_Email__c</field>
            <value>
                <elementReference>ClientEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Comments__c</field>
            <value>
                <elementReference>CommentsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Credit_Sale__c</field>
            <value>
                <elementReference>CreditSaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Date_of_Original_Payment__c</field>
            <value>
                <elementReference>Date_of_Original_Payment</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Expedite_Requested_by_Manager__c</field>
            <value>
                <elementReference>ExpediteFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_the_client_keeping_Platinum_services__c</field>
            <value>
                <elementReference>After_the_refund_will_the_client_keep_Platinum_services</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_this_a_duplicate_charge__c</field>
            <value>
                <elementReference>DuplicateChargeFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_Four_Digits_of_Purchase_Card__c</field>
            <value>
                <elementReference>Last_Four_Digits_of_Purchase_Card</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_four_of_card_or_full_check_number__c</field>
            <value>
                <elementReference>Last_Four_of_Card_or_Full_Check_Number</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address_Confirmed__c</field>
            <value>
                <elementReference>Mailing_Address_Verified</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address__c</field>
            <value>
                <elementReference>AccountAddress</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>RefundNameFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Other_Items_Description__c</field>
            <value>
                <elementReference>OtherItemsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>OwnerFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Comments__c</field>
            <value>
                <elementReference>Payment_Research_Comments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Requested__c</field>
            <value>
                <elementReference>fmResearchRequest</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Type__c</field>
            <value>
                <elementReference>Payment_Research_Type</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Reason__c</field>
            <value>
                <elementReference>Refund_Reason</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Request_Signed__c</field>
            <value>
                <elementReference>Refund_Request_Signed</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Request_Type__c</field>
            <value>
                <elementReference>varRequestType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Research_Amount__c</field>
            <value>
                <elementReference>AmountResearch</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Sale__c</field>
            <value>
                <elementReference>SaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Services_to_be_Refunded__c</field>
            <value>
                <elementReference>ServiceORRefundServiceselected</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <elementReference>StatusFormula</elementReference>
            </value>
        </inputAssignments>
        <object>Refund__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_Refund_0</name>
        <label>Create Refund</label>
        <locationX>1683</locationX>
        <locationY>427</locationY>
        <connector>
            <targetReference>Should_Flow_Change_Sale_Stage</targetReference>
        </connector>
        <inputAssignments>
            <field>Amount__c</field>
            <value>
                <elementReference>AmountFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Check_or_Wire_Amount__c</field>
            <value>
                <elementReference>Check_or_Wire_Amount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client__c</field>
            <value>
                <elementReference>AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client_s_Email__c</field>
            <value>
                <elementReference>ClientEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Comments__c</field>
            <value>
                <elementReference>CommentsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Credit_Sale__c</field>
            <value>
                <elementReference>CreditSaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Date_of_Original_Payment__c</field>
            <value>
                <elementReference>Date_of_Original_Payment</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Expedite_Requested_by_Manager__c</field>
            <value>
                <elementReference>ExpediteFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_the_client_keeping_Platinum_services__c</field>
            <value>
                <elementReference>After_the_refund_will_the_client_keep_Platinum_services</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_this_a_duplicate_charge__c</field>
            <value>
                <elementReference>DuplicateChargeFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_Four_Digits_of_Purchase_Card__c</field>
            <value>
                <elementReference>Last_Four_Digits_of_Purchase_Card</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_four_of_card_or_full_check_number__c</field>
            <value>
                <elementReference>Last_Four_of_Card_or_Full_Check_Number</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address_Confirmed__c</field>
            <value>
                <elementReference>Mailing_Address_Verified</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address__c</field>
            <value>
                <elementReference>AccountAddress</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>RefundNameFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Other_Items_Description__c</field>
            <value>
                <elementReference>OtherItemsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>OwnerFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Comments__c</field>
            <value>
                <elementReference>Payment_Research_Comments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Requested__c</field>
            <value>
                <elementReference>fmResearchRequest</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Type__c</field>
            <value>
                <elementReference>Payment_Research_Type</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Reason__c</field>
            <value>
                <elementReference>Refund_Reason</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Request_Signed__c</field>
            <value>
                <elementReference>Refund_Request_Signed</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Request_Type__c</field>
            <value>
                <elementReference>varRequestType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Research_Amount__c</field>
            <value>
                <elementReference>AmountResearch</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Sale__c</field>
            <value>
                <elementReference>SaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Services_to_be_Refunded__c</field>
            <value>
                <elementReference>ServiceORRefundServiceselected</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <elementReference>StatusFormula</elementReference>
            </value>
        </inputAssignments>
        <object>Refund__c</object>
    </recordCreates>
    <recordCreates>
        <name>Create_Refund_0_0</name>
        <label>Create Refund</label>
        <locationX>1693</locationX>
        <locationY>1101</locationY>
        <connector>
            <targetReference>Should_Flow_Change_Sale_Stage</targetReference>
        </connector>
        <inputAssignments>
            <field>Amount__c</field>
            <value>
                <elementReference>AmountFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Check_or_Wire_Amount__c</field>
            <value>
                <elementReference>Check_or_Wire_Amount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client__c</field>
            <value>
                <elementReference>AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Client_s_Email__c</field>
            <value>
                <elementReference>ClientEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Comments__c</field>
            <value>
                <elementReference>CommentsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Credit_Sale__c</field>
            <value>
                <elementReference>CreditSaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Date_of_Original_Payment__c</field>
            <value>
                <elementReference>Date_of_Original_Payment</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Expedite_Requested_by_Manager__c</field>
            <value>
                <elementReference>ExpediteFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_the_client_keeping_Platinum_services__c</field>
            <value>
                <elementReference>After_the_refund_will_the_client_keep_Platinum_services</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Is_this_a_duplicate_charge__c</field>
            <value>
                <elementReference>DuplicateChargeFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_Four_Digits_of_Purchase_Card__c</field>
            <value>
                <elementReference>Last_Four_Digits_of_Purchase_Card</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Last_four_of_card_or_full_check_number__c</field>
            <value>
                <elementReference>Last_Four_of_Card_or_Full_Check_Number</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address_Confirmed__c</field>
            <value>
                <elementReference>Mailing_Address_Verified</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Mailing_Address__c</field>
            <value>
                <elementReference>AccountAddress</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>RefundNameFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Other_Items_Description__c</field>
            <value>
                <elementReference>OtherItemsFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>OwnerFormula</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Comments__c</field>
            <value>
                <elementReference>Payment_Research_Comments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Requested__c</field>
            <value>
                <elementReference>fmResearchRequest</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Payment_Research_Type__c</field>
            <value>
                <elementReference>Payment_Research_Type</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Reason__c</field>
            <value>
                <elementReference>Refund_Reason</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Request_Signed__c</field>
            <value>
                <elementReference>Refund_Request_Signed</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Request_Type__c</field>
            <value>
                <elementReference>varRequestType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Research_Amount__c</field>
            <value>
                <elementReference>AmountResearch</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Sale__c</field>
            <value>
                <elementReference>SaleId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Services_to_be_Refunded__c</field>
            <value>
                <elementReference>ServiceORRefundServiceselected</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <elementReference>StatusFormula</elementReference>
            </value>
        </inputAssignments>
        <object>Refund__c</object>
    </recordCreates>
    <recordLookups>
        <name>Find_Account</name>
        <label>Find Account</label>
        <locationX>436</locationX>
        <locationY>139</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Find_OLIs</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>AccountId</elementReference>
            </value>
        </filters>
        <object>Account</object>
        <outputAssignments>
            <assignToReference>ClientEmail</assignToReference>
            <field>E_Mail__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ClientName</assignToReference>
            <field>Name</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingAddress</assignToReference>
            <field>ShippingAddress</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingCity</assignToReference>
            <field>ShippingCity</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingCountry</assignToReference>
            <field>ShippingCountry</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingZip</assignToReference>
            <field>ShippingPostalCode</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingState</assignToReference>
            <field>ShippingState</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>ShippingStreet</assignToReference>
            <field>ShippingStreet</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Find_Credit_Sale</name>
        <label>Find Credit Sale</label>
        <locationX>229</locationX>
        <locationY>442</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Refund_Request_Flow</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Credit to be Used</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputAssignments>
            <assignToReference>CreditSaleId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Find_OLIs</name>
        <label>Find OLIs</label>
        <locationX>573</locationX>
        <locationY>139</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Looping</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SaleId</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>OppOLIs</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>TotalPrice</queriedFields>
        <queriedFields>Service_Name__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Update_Sale</name>
        <label>Update Sale</label>
        <locationX>2115</locationX>
        <locationY>601</locationY>
        <connector>
            <targetReference>Complete</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SaleId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>StageName</field>
            <value>
                <stringValue>Refund Requested</stringValue>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <screens>
        <name>Are_you_a_manager</name>
        <label>Are you a manager?</label>
        <locationX>1546</locationX>
        <locationY>738</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Create_Refund</targetReference>
        </connector>
        <fields>
            <name>ManagerText</name>
            <fieldText>&lt;p&gt;If you&apos;re a manager and need the refund to be expedited directly to Michelle Fuller, check the box below.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Refund</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Yes_please_expedite_directly_to_Michelle</name>
            <dataType>Boolean</dataType>
            <defaultValue>
                <booleanValue>false</booleanValue>
            </defaultValue>
            <fieldText>Yes, please expedite directly to David.</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Refund</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Credit_Request</name>
            <fieldText>&lt;p&gt;This refund request is for a Credit. Please click &apos;Next&apos; below and it will assign to the appropriate person.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Credit</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Complete</name>
        <label>Complete</label>
        <locationX>2115</locationX>
        <locationY>950</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>CreatedRecord</name>
            <fieldText>Refund record Created successfully. Please exit the window.</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Events_Screen</name>
        <label>Events</label>
        <locationX>1156</locationX>
        <locationY>985</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Are_you_a_manager</targetReference>
        </connector>
        <fields>
            <name>Last_Four_Digits_of_Purchase_Card</name>
            <dataType>Number</dataType>
            <fieldText>Last Four Digits of Purchase Card</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>0</scale>
        </fields>
        <fields>
            <name>Events_Screen_Text</name>
            <fieldText>&lt;p&gt;This is an Events sale.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Clicking finish will assign the refund record to the appropriate person.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>KambriasScreen</name>
        <label>KambriasScreen</label>
        <locationX>388</locationX>
        <locationY>1091</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Does_Kambria_want_to_Expedite</targetReference>
        </connector>
        <fields>
            <name>Hi_Kambria</name>
            <fieldText>&lt;p&gt;Hi Kambria! You&apos;re awesome. Would you like to expedite this one immediately?&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Send_to_Michelle_immediately</name>
            <dataType>Boolean</dataType>
            <fieldText>Send to Michelle immediately?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Expedited_Comments</name>
            <fieldText>Expedited Comments</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>OtherScreen</name>
        <label>Other</label>
        <locationX>1300</locationX>
        <locationY>816</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Are_you_a_manager</targetReference>
        </connector>
        <fields>
            <name>OtherDescription</name>
            <fieldText>Please provide a description of the items to be refunded:</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Other_Items</name>
            <fieldText>Other Items</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Payment_Research_Screen</name>
        <label>Payment Research</label>
        <locationX>1264</locationX>
        <locationY>545</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Create_Refund_0</targetReference>
        </connector>
        <fields>
            <name>Research_Display_Text</name>
            <fieldText>Please select the type of payment research required</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Payment_Research_Type</name>
            <choiceReferences>ResearchType</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Payment Research Type</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Payment_Research_Comments</name>
            <fieldText>Payment Research Comments</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>AmountResearch</name>
            <dataType>Currency</dataType>
            <fieldText>Research Amount?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
        </fields>
        <fields>
            <name>Date_of_Original_Payment</name>
            <dataType>Date</dataType>
            <fieldText>Date of Original Payment</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Last_Four_of_Card_or_Full_Check_Number</name>
            <dataType>String</dataType>
            <fieldText>Last Four of Card or Full Check Number</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Check_or_Wire_Amount</name>
            <dataType>Currency</dataType>
            <fieldText>Check or Wire Amount (zero if nothing)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Platinum_Subscription_Screen</name>
        <label>Platinum Subscription</label>
        <locationX>1262</locationX>
        <locationY>907</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Are_you_a_manager</targetReference>
        </connector>
        <fields>
            <name>Platinum_Display_Text</name>
            <fieldText>&lt;p&gt;This is sale is a Platinum Sale. &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Was_the_Platinum_subscription_stopped</name>
            <dataType>Boolean</dataType>
            <fieldText>Was the Platinum subscription stopped?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Refund_Credit_or_Research</name>
        <label>Refund, Credit, or Research</label>
        <locationX>953</locationX>
        <locationY>156</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Type_of_Request0</targetReference>
        </connector>
        <fields>
            <name>X1st_Screen</name>
            <fieldText>&lt;p&gt;Are you requesting a refund, a credit, or a research request?&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Type_of_Request</name>
            <choiceReferences>Refund</choiceReferences>
            <choiceReferences>Credit</choiceReferences>
            <choiceReferences>Research</choiceReferences>
            <choiceReferences>DuplicateCharge2</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Type of Request</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Refund_Request_Flow</name>
        <label>Refund Request Flow</label>
        <locationX>401</locationX>
        <locationY>526</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Is_Current_User_Kambria</targetReference>
        </connector>
        <fields>
            <name>Services</name>
            <fieldText>&lt;p&gt;The following services are on the Sale. &lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;Copy and paste this list below and then update the quantity and prices to match the requested refund.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;{!serviceDisplayText}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Which_services_are_being_refunded</name>
            <fieldText>Which services are being refunded?</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Refund</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Which_services_are_being_credited</name>
            <fieldText>Which services are being credited?</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Credit</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Refund_Reason</name>
            <choiceReferences>RefundReason</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Refund Reason</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Other_Items_Description</name>
            <fieldText>Description - Please Be Detailed</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Refund_Reason</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Other</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Refund_Amount</name>
            <dataType>Currency</dataType>
            <fieldText>Refund Amount?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Refund</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Credit_Amount</name>
            <dataType>Currency</dataType>
            <fieldText>Credit Amount?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>varRequestType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Credit</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Refund_Request_Signed</name>
            <choiceReferences>RefundRequestForm</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Refund Request Signed?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>RefundReason</leftValueReference>
                    <operator>NotEqualTo</operator>
                    <rightValue>
                        <stringValue>Seven Day Refund Period</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>After_the_refund_will_the_client_keep_Platinum_services</name>
            <choiceReferences>isKeepingPlatinum</choiceReferences>
            <dataType>String</dataType>
            <fieldText>If the client currently has Platinum, after the refund, will the client keep Platinum services?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>ClientsMailingAddress</name>
            <fieldText>The following address is listed on the account page: 

{!ShippingStreet} {!ShippingCity} {!ShippingState} {!ShippingZip} {!ShippingCountry}

Please verify if this is the correct mailing address.</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Mailing_Address_Verified</name>
            <choiceReferences>MailingAddressConfirmedChoices</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Mailing Address Verified?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Is_this_refund_for_tax_penalties_hotel_cancellation_fees_or_other_items</name>
            <choiceReferences>OtherItems</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Is this refund for tax penalties, hotel cancellation fees, or other non service items?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>50</locationX>
        <locationY>121</locationY>
        <connector>
            <targetReference>Find_Account</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>AccountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ClientEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ClientName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CreditSaleId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>loopOppProd</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>OppOLIs</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>SaleId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>SaleName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SaleType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>serviceDisplayText</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ShippingAddress</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ShippingCity</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ShippingCountry</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ShippingState</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ShippingStreet</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ShippingZip</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varRequestType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
