trigger Send_email_to_case_creator on CaseComment (after insert,after update) {
    
    List<Messaging.SingleEmailMessage> mails =  new List<Messaging.SingleEmailMessage>();
    List<CaseComment> cc = new List<CaseComment>();
    RecordType rt = [SELECT Id, Name, SobjectType FROM RecordType where name = 'Community Platinum Case' and SobjectType = 'Case'];
    OrgWideEmailAddress[] owea = [select Id from OrgWideEmailAddress where Address = 'info@andersonadvisors.com'];
    for(CaseComment c : trigger.new){
        if(Trigger.IsUpdate){
             CaseComment oldCasecoment = Trigger.oldMap.get(c.Id);
               if(c.IsPublished){  
            if(oldCasecoment.IsPublished!=c.IsPublished || oldCasecoment.CommentBody!=C.CommentBody){
               case cse = [select id,CreatedById,RecordTypeId from case where id = :c.ParentId];
        system.debug('=== cse ==='+ cse.CreatedById);
        if(cse.RecordTypeId == rt.id) {
            User usr = [select id,Email,FirstName,LastName from User where id = :cse.CreatedById];
            system.debug('=== usr ==='+ usr);
            Messaging.SingleEmailMessage mail =  new Messaging.SingleEmailMessage();
            //  list of people who should get the email
            List<String> sendTo = new List<String>();
            system.debug('=== usr.Email ==='+ usr.Email);
            sendTo.add(usr.Email);
            mail.setToAddresses(sendTo);
          
            // Set email is sent from
            mail.setReplyTo('noreply@andersonadvisors.com');
          //  mail.setSenderDisplayName('Anderson Advisors');
              if ( owea.size() > 0 ) {
    mail.setOrgWideEmailAddressId(owea.get(0).Id);
}
            // Set email contents
            mail.setSubject('Anderson Platinum Question Response');
            //String body = 'Dear ' + usr.FirstName +' '+ usr.LastName + ', ';
            String body = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta content="text/html; charset=utf-8" http-equiv="Content-Type" /> <!-- Facebook sharing information tags --> <meta property="og:title" content="%%subject%%" /> <title>Anderson Business Advisors</title> </head> <body bgcolor="#ffffff" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; height: 100% !important; width: 100% !important; background-color: #ffffff; margin: 0; padding: 0;"> <style type="text/css">#outlook a { padding: 0; } .body{ width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; margin: 0; padding: 0; } .ExternalClass { width:100%; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } img { outline: none; text-decoration: none; -ms-interpolation-mode: bicubic; } a img { border: none; } p { margin: 1em 0; } table td { border-collapse: collapse; } /* hide unsubscribe from forwards*/ blockquote .original-only, .WordSection1 .original-only { display: none !important; } @media only screen and (max-width: 480px){ body, table, td, p, a, li, blockquote{-webkit-text-size-adjust:none !important;} /* Prevent Webkit platforms from changing default text sizes */ body{width:100% !important; min-width:100% !important;} /* Prevent iOS Mail from adding padding to the body */ #bodyCell{padding:10px !important;} #templateContainer{ max-width:600px !important; width:100% !important; } h1{ font-size:24px !important; line-height:100% !important; } h2{ font-size:20px !important; line-height:100% !important; } h3{ font-size:18px !important; line-height:100% !important; } h4{ font-size:16px !important; line-height:100% !important; } #templatePreheader{display:none !important;} /* Hide the template preheader to save space */ #headerImage{ height:auto !important; max-width:600px !important; width:100% !important; } .headerContent{ font-size:20px !important; line-height:125% !important; } #bodyImage{ height:auto !important; max-width:560px !important; width:100% !important; } .bodyContent{ font-size:18px !important; line-height:125% !important; } .footerContent{ font-size:14px !important; line-height:115% !important; } .footerContent a{display:block !important;} /* Place footer social and utility links on their own lines, for easier access */ } </style> <table align="center" border="0" cellpadding="0" cellspacing="0" id="bodyTable" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #ffffff; border-collapse: collapse !important; height: 100% !important; margin: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; padding: 0; width: 100% !important" width="100%"><!--PREVIEW TEXT!!--> <tbody> <tr> <td align="center" id="bodyCell" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; height: 100% !important; width: 100% !important;margin: 0; padding: 20px;" valign="top"><!-- BEGIN TEMPLATE // --> <table border="0" cellpadding="0" cellspacing="0" id="templateContainer" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse !important; width: 600px; border: 1px solid #dddddd;"> <tbody> <tr> <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top"><!-- BEGIN HEADER // --> <table border="0" cellpadding="0" cellspacing="0" id="templateHeader" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #FFFFFF; border-bottom-color: #CCCCCC; border-bottom-style: solid; border-bottom-width: 0px; border-collapse: collapse !important; mso-table-lspace: 0pt; mso-table-rspace: 0pt" width="100%"> <tbody> <tr pardot-repeatable=""> <td valign="top"> <table border="0" cellpadding="0" cellspacing="0" class="mcnImageBlock" style="min-width:100%;" width="100%"> <tbody class="mcnImageBlockOuter"> <tr> <td class="mcnImageBlockInner" style="" valign="top"> <table align="left" border="0" cellpadding="0" cellspacing="0" class="mcnImageContentContainer" style="min-width:100%;" width="100%"> <tbody> <tr> <td class="mcnImageContent" style="padding-right: 10px; padding-left: 10px; padding-top: 30px; padding-bottom: 30px; text-align:center;" valign="top"><img align="center" alt="Anderson Business Advisors" class="mcnImage" src="http://go.andersonadvisors.com/l/142061/2018-01-31/4tx3d9/142061/94364/Anderson_Logo.png" style="max-width:200px; padding-bottom: 0; display: inline !important; vertical-align: bottom;" width="200"></td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </td> </tr> <tr pardot-repeatable=""> <td align="left" class="headerContent" pardot-region="header_image" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #505050; font-family: Helvetica; font-size: 20px; font-weight: bold; line-height: 20px; text-align: left; vertical-align: middle; padding: 0;" valign="top"><img alt="" id="headerImage" src="http://go.andersonadvisors.com/l/142061/2018-03-06/4xg29d/142061/97951/AvailableNow.jpg" style="max-width: 600px; -ms-interpolation-mode: bicubic; height: auto; outline: none; text-decoration: none; border: 0;"></td> </tr> </tbody> </table> <!-- // END HEADER --></td> </tr> <tr> <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top"><!-- BEGIN BODY // --> <table border="0" cellpadding="0" cellspacing="0" id="templateBody" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #FFFFFF; border-bottom-color: #CCCCCC; border-bottom-style: solid; border-bottom-width: 1px; border-collapse: collapse !important; border-top-color: #FFFFFF; border-top-style: solid; border-top-width: 1px; mso-table-lspace: 0pt; mso-table-rspace: 0pt" width="100%"> <tbody> <tr pardot-repeatable=""> <td align="left" class="bodyContent" pardot-region="body_content00" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #505050; font-family: Helvetica; font-size: 14px; line-height: 21px; text-align: left; padding: 20px;" valign="top"> <h1 style="text-align: center"><br> Hi '+ usr.FirstName +' '+usr.LastName +',</h1> &nbsp; <div><meta charset="utf-8"> <p dir="ltr" style="text-align: center"> You have received a response to your Platinum question! <br> Log into the platinum portal to view the item using the button below.<br> <br> <a href="https://platinum.force.com/dashboard/Anderson_Login?startURL=%2Fdashboard" target="_blank" class="btn" style="text-decoration:none;color: #FFF;background-color: #666;padding:10px 16px;font-weight:bold;text-align:center;cursor:pointer;display:inline-block;width: 50%;">Login</a><br><br> <!-- <i> Go to: {!Community_Url}</i><br> --> <br><br><br> <!-- Please use the following link for access to the new platinum portal after you have reset your password: <a href="https://platinum.force.com/dashboard/Anderson_Login?startURL=%2Fdashboard">**Platinum Portal Link**</a><br> --> <br> If you have any questions, please feel free to contact us through your portal or give us a call at <a href="tel:+18007064741" style="color: #8c8c8c; font-weight: bold;">800.706.4741</a></p> </div> </td> </tr> </tbody> </table> </td> </tr> </tbody> </table> <!-- // END BODY --></td> </tr> </tbody> </table> <!-- // END TEMPLATE --><br> <!-- This email was originally designed by the wonderful folks at MailChimp and remixed by Pardot. It is licensed under CC BY-SA 3.0 --> </body> </html>';
            
            mail.setHtmlBody(body);        
            // Add your email to the master list
            mails.add(mail);
            system.debug('=== mails ==='+ mails);
            // Send all emails in the master list
            
        }
        }
     
    }
        }
        else if(Trigger.IsInsert){
              if(c.IsPublished){  
            
               case cse = [select id,CreatedById,RecordTypeId from case where id = :c.ParentId];
        system.debug('=== cse ==='+ cse.CreatedById);
        if(cse.RecordTypeId == rt.id) {
            User usr = [select id,Email,FirstName,LastName from User where id = :cse.CreatedById];
            system.debug('=== usr ==='+ usr);
            Messaging.SingleEmailMessage mail =  new Messaging.SingleEmailMessage();
            //  list of people who should get the email
            List<String> sendTo = new List<String>();
            system.debug('=== usr.Email ==='+ usr.Email);
            sendTo.add(usr.Email);
            mail.setToAddresses(sendTo);
            
            // Set email is sent from
            mail.setReplyTo('noreply@andersonadvisors.com');
           // mail.setSenderDisplayName('Anderson Advisors');
               if ( owea.size() > 0 ) {
    mail.setOrgWideEmailAddressId(owea.get(0).Id);
}
            // Set email contents
            mail.setSubject('Anderson Platinum Question Response');
            //String body = 'Dear ' + usr.FirstName +' '+ usr.LastName + ', ';
            String body = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta content="text/html; charset=utf-8" http-equiv="Content-Type" /> <!-- Facebook sharing information tags --> <meta property="og:title" content="%%subject%%" /> <title>Anderson Business Advisors</title> </head> <body bgcolor="#ffffff" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; height: 100% !important; width: 100% !important; background-color: #ffffff; margin: 0; padding: 0;"> <style type="text/css">#outlook a { padding: 0; } .body{ width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; margin: 0; padding: 0; } .ExternalClass { width:100%; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } img { outline: none; text-decoration: none; -ms-interpolation-mode: bicubic; } a img { border: none; } p { margin: 1em 0; } table td { border-collapse: collapse; } /* hide unsubscribe from forwards*/ blockquote .original-only, .WordSection1 .original-only { display: none !important; } @media only screen and (max-width: 480px){ body, table, td, p, a, li, blockquote{-webkit-text-size-adjust:none !important;} /* Prevent Webkit platforms from changing default text sizes */ body{width:100% !important; min-width:100% !important;} /* Prevent iOS Mail from adding padding to the body */ #bodyCell{padding:10px !important;} #templateContainer{ max-width:600px !important; width:100% !important; } h1{ font-size:24px !important; line-height:100% !important; } h2{ font-size:20px !important; line-height:100% !important; } h3{ font-size:18px !important; line-height:100% !important; } h4{ font-size:16px !important; line-height:100% !important; } #templatePreheader{display:none !important;} /* Hide the template preheader to save space */ #headerImage{ height:auto !important; max-width:600px !important; width:100% !important; } .headerContent{ font-size:20px !important; line-height:125% !important; } #bodyImage{ height:auto !important; max-width:560px !important; width:100% !important; } .bodyContent{ font-size:18px !important; line-height:125% !important; } .footerContent{ font-size:14px !important; line-height:115% !important; } .footerContent a{display:block !important;} /* Place footer social and utility links on their own lines, for easier access */ } </style> <table align="center" border="0" cellpadding="0" cellspacing="0" id="bodyTable" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #ffffff; border-collapse: collapse !important; height: 100% !important; margin: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; padding: 0; width: 100% !important" width="100%"><!--PREVIEW TEXT!!--> <tbody> <tr> <td align="center" id="bodyCell" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; height: 100% !important; width: 100% !important;margin: 0; padding: 20px;" valign="top"><!-- BEGIN TEMPLATE // --> <table border="0" cellpadding="0" cellspacing="0" id="templateContainer" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse !important; width: 600px; border: 1px solid #dddddd;"> <tbody> <tr> <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top"><!-- BEGIN HEADER // --> <table border="0" cellpadding="0" cellspacing="0" id="templateHeader" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #FFFFFF; border-bottom-color: #CCCCCC; border-bottom-style: solid; border-bottom-width: 0px; border-collapse: collapse !important; mso-table-lspace: 0pt; mso-table-rspace: 0pt" width="100%"> <tbody> <tr pardot-repeatable=""> <td valign="top"> <table border="0" cellpadding="0" cellspacing="0" class="mcnImageBlock" style="min-width:100%;" width="100%"> <tbody class="mcnImageBlockOuter"> <tr> <td class="mcnImageBlockInner" style="" valign="top"> <table align="left" border="0" cellpadding="0" cellspacing="0" class="mcnImageContentContainer" style="min-width:100%;" width="100%"> <tbody> <tr> <td class="mcnImageContent" style="padding-right: 10px; padding-left: 10px; padding-top: 30px; padding-bottom: 30px; text-align:center;" valign="top"><img align="center" alt="Anderson Business Advisors" class="mcnImage" src="http://go.andersonadvisors.com/l/142061/2018-01-31/4tx3d9/142061/94364/Anderson_Logo.png" style="max-width:200px; padding-bottom: 0; display: inline !important; vertical-align: bottom;" width="200"></td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </td> </tr> <tr pardot-repeatable=""> <td align="left" class="headerContent" pardot-region="header_image" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #505050; font-family: Helvetica; font-size: 20px; font-weight: bold; line-height: 20px; text-align: left; vertical-align: middle; padding: 0;" valign="top"><img alt="" id="headerImage" src="http://go.andersonadvisors.com/l/142061/2018-03-06/4xg29d/142061/97951/AvailableNow.jpg" style="max-width: 600px; -ms-interpolation-mode: bicubic; height: auto; outline: none; text-decoration: none; border: 0;"></td> </tr> </tbody> </table> <!-- // END HEADER --></td> </tr> <tr> <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt;" valign="top"><!-- BEGIN BODY // --> <table border="0" cellpadding="0" cellspacing="0" id="templateBody" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; background-color: #FFFFFF; border-bottom-color: #CCCCCC; border-bottom-style: solid; border-bottom-width: 1px; border-collapse: collapse !important; border-top-color: #FFFFFF; border-top-style: solid; border-top-width: 1px; mso-table-lspace: 0pt; mso-table-rspace: 0pt" width="100%"> <tbody> <tr pardot-repeatable=""> <td align="left" class="bodyContent" pardot-region="body_content00" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #505050; font-family: Helvetica; font-size: 14px; line-height: 21px; text-align: left; padding: 20px;" valign="top"> <h1 style="text-align: center"><br> Hi '+ usr.FirstName +' '+usr.LastName +',</h1> &nbsp; <div><meta charset="utf-8"> <p dir="ltr" style="text-align: center"> You have received a response to your Platinum question! <br> Log into the platinum portal to view the item using the button below.<br> <br> <a href="https://platinum.force.com/dashboard/Anderson_Login?startURL=%2Fdashboard" target="_blank" class="btn" style="text-decoration:none;color: #FFF;background-color: #666;padding:10px 16px;font-weight:bold;text-align:center;cursor:pointer;display:inline-block;width: 50%;">Login</a><br><br> <!-- <i> Go to: {!Community_Url}</i><br> --> <br><br><br> <!-- Please use the following link for access to the new platinum portal after you have reset your password: <a href="https://platinum.force.com/dashboard/Anderson_Login?startURL=%2Fdashboard">**Platinum Portal Link**</a><br> --> <br> If you have any questions, please feel free to contact us through your portal or give us a call at <a href="tel:+18007064741" style="color: #8c8c8c; font-weight: bold;">800.706.4741</a></p> </div> </td> </tr> </tbody> </table> </td> </tr> </tbody> </table> <!-- // END BODY --></td> </tr> </tbody> </table> <!-- // END TEMPLATE --><br> <!-- This email was originally designed by the wonderful folks at MailChimp and remixed by Pardot. It is licensed under CC BY-SA 3.0 --> </body> </html>';
            
            mail.setHtmlBody(body);        
            // Add your email to the master list
            mails.add(mail);
            system.debug('=== mails ==='+ mails);
            // Send all emails in the master list
            
       
        }
        }
       
        
     
        
    }
   
    
}
      if(mails.size()>0) {
                Messaging.sendEmail(mails);
                system.debug('=== Mail Sent ===');
            }
}